<?php/** * YZOI Online Judge System * * @copyright   Copyright (c) 2010 YZOI * @author      xaero <xaero@msn.cn> * @version     $Id: IndexController.php 2015-10-22 18:14 $ */namespace YZOI\Controllers;use Phalcon\Crypt;use YZOI\Models\Contests;use YZOI\Models\Topics;use YZOI\Models\Users;use YZOI\CoolCaptcha\SimpleCaptcha;class IndexController extends ControllerBase{    public function initialize()    {        parent::initialize(); // TODO: Change the autogenerated stub    }    public function indexAction()    {        $this->view->title = __('pageTitle');        $this->view->user_topx = Users::findUsersRanks(10);        $this->view->user_topx_monthly = Users::findUsersRanks_monthly(10);        $this->view->contests = Contests::find(["active = 'Y'", 'limit'=>8, 'order'=>'id desc']);        $this->view->topics = Topics::findAllTopicsBySql(null, null, 6);        //echo __('hi', ['asdf'=>'2222asfwea']);        //echo _('hi');        //echo $_SERVER['HTTP_HOST'];        /**        $crypt = new Crypt();        $crypt->setMode('cfb');        var_dump($crypt->getAvailableCiphers());        //$key = $this->config->application->cryptSalt;        $key = ".";        $text = '12345x67';        $encrypt = $crypt->encryptBase64($text, $key, true);        var_dump($encrypt);        echo ($crypt->decryptBase64($encrypt, $key, true));        echo var_dump($crypt->decryptBase64($encrypt, $key, true));         * */        /*echo $_SERVER['HTTP_HOST']."<br>";        echo "<br>";        echo $this->url->getBaseUri();*/        //echo date('Y').'-'.date('m').'-01';        //echo strtotime(date('Y').'-'.date('m').'-01');    }    public function captchaAction()    {        $this->view->disable();        //if ($this->request->isAjax()) {            $captcha = new SimpleCaptcha();            $captcha->shadowColor = array(57, 55, 55);            // OPTIONAL Change configuration...            //$captcha->wordsFile = 'words/es.php';            $captcha->session_var = '_Yyzoix@HKJLSP';            //$captcha->imageFormat = 'png';            $captcha->lineWidth = 2;            //$captcha->scale = 1;            //$captcha->blur = true;            //$captcha->resourcesPath = "/var/cool-php-captcha/resources";            // OPTIONAL Simple autodetect language example            /*            if (!empty($_SERVER['HTTP_ACCEPT_LANGUAGE'])) {                $langs = array('en', 'es');                $lang  = substr($_SERVER['HTTP_ACCEPT_LANGUAGE'], 0, 2);                if (in_array($lang, $langs)) {                    $captcha->wordsFile = "words/$lang.php";                }            }            */            // Image generation            $captcha->CreateImage();            //var_dump($captcha);        //} else {        //    return $this->response->redirect("");        //}    }	    public function e404Action()    {        $this->view->setRenderLevel(\Phalcon\Mvc\View::LEVEL_ACTION_VIEW);        $this->view->pick('e404');    }    public function e500Action()    {        $this->view->setRenderLevel(\Phalcon\Mvc\View::LEVEL_ACTION_VIEW);        $this->view->pick('e500');    }}